jQuery.fn.xeyes=function(l){l=$.extend({padding:0,radius:'natural',onHover:'follow',position:'center',trigger:window,triggerOut:undefined,triggerOutSpeed:1000},l);var m=parseInt(l.padding,10);this.each(function(c,d){var f=$(d),$eye=f.parent();$(d).css('position','absolute').parent().css('position','relative');var g=f.outerWidth(),irisH=f.outerHeight(),eyeW=$eye.width(),eyeH=$eye.height(),defX=eyeW/2-g/2,defY=eyeH/2-irisH/2;if(l.radius=='circular'&&eyeW>eyeH){eyeW=eyeH}else if(l.radius=='circular'){eyeH=eyeW}$(d).css("left",defX+"px").css("top",defY+"px");var h=f.offset(),offX=h.left+g/2,offY=h.top+irisH/2,position={top:{degree:90},bottom:{degree:-90},left:{degree:180},right:{degree:0},topRight:{degree:45},topLeft:{degree:135},bottomRight:{degree:-45},bottomLeft:{degree:-135}};if(l.position.x){f.css("left",defX-parseInt(l.position.x,10)+"px").css("top",defY-parseInt(l.position.y,10)+"px")}else if(l.position.degree!==undefined){var i=l.position.degree*Math.PI/-180;f.css("left",defX+Math.cos(i)*(eyeW/2-g/2-m)+"px").css("top",defY+Math.sin(i)*(eyeH/2-irisH/2-m)+"px")}else if(l.position=="center"){f.css("left",defX+"px").css("top",defY+"px")}else{var j=position[l.position].degree*Math.PI/-180;f.css("left",defX+Math.cos(j)*(eyeW/2-g/2-m)+"px").css("top",defY+Math.sin(j)*(eyeH/2-irisH/2-m)+"px")}var k=function(e){f.stop().clearQueue();var a=Math.atan((e.pageY-offY)/(e.pageX-offX)),direction=(offX>=e.pageX)?-1:1,newX=Math.cos(a)*(eyeW/2-g/2-m)*direction,newY=Math.sin(a)*(eyeH/2-irisH/2-m)*direction,radius=Math.sqrt(Math.pow(newX,2)+Math.pow(newY,2)),distance=Math.sqrt(Math.pow(e.pageY-offY,2)+Math.pow(e.pageX-offX,2));if(radius>distance&&l.onHover.toLowerCase()!='nofollow'){f.css("left",(e.pageX-offX+defX)+"px").css("top",(e.pageY-offY+defY)+"px")}else{f.css("left",defX+newX+"px").css("top",defY+newY+"px")}},eyesReset=function(e){if(l.triggerOut!=undefined){if(l.triggerOut.x){f.animate({left:defX-parseInt(l.triggerOut.x,10)+"px",top:defY-parseInt(l.triggerOut.y,10)+"px"},l.triggerOutSpeed)}else if(l.triggerOut.degree!==undefined){var a=l.triggerOut.degree*Math.PI/-180;f.animate({left:defX+Math.cos(a)*(eyeW/2-g/2-m)+"px",top:defY+Math.sin(a)*(eyeH/2-irisH/2-m)+"px"},l.triggerOutSpeed)}else if(l.triggerOut=="center"){f.animate({left:defX+"px",top:defY+"px"},l.triggerOutSpeed)}else{var b=position[l.triggerOut].degree*Math.PI/-180;f.animate({left:defX+Math.cos(b)*(eyeW/2-g/2-m)+"px",top:defY+Math.sin(b)*(eyeH/2-irisH/2-m)+"px"},l.triggerOutSpeed)}}};$(l.trigger).mousemove(k).mouseleave(eyesReset);$(window).resize(function(){h=f.offset();offX=h.left+g/2;offY=h.top+irisH/2})})};
